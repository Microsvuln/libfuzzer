TODO
 - remove warnings
 - remove useless cov update & merge to speedup